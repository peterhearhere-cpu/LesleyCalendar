<!DOCTYPE html>

<html>
<head>
<title>Lesley's Calendar</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body { font-family: sans-serif; background: #f4f4f4; margin: 0; padding: 10px; }
.header { display: flex; justify-content: space-between; align-items: center; background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); margin-bottom: 10px; }
button.nav { padding: 10px 20px; font-size: 16px; cursor: pointer; background: #eee; border: none; border-radius: 5px; }
h2 { margin: 0; color: #333; }
.grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; }
.day-header { text-align: center; font-weight: bold; padding: 10px 0; color: #555; font-size: 0.8em; }

    /* The Day Buttons */
    .day-btn { height: 80px; background: white; border: 1px solid #ccc; border-radius: 5px; font-size: 18px; font-weight: bold; cursor: pointer; position: relative; }
    
    /* Weekend Styling */
    .day-btn.weekend { background-color: #f9f9f9; color: #777; }
    
    /* Event Styling (Yellow Post-it feel) */
    .day-btn.has-event { background-color: #fff9c4; border: 2px solid #fbc02d; color: #d32f2f; }
    
    /* Today's Blue Border */
    .day-btn.today { border: 2px solid #2196f3; }
    
    /* Popup Styling */
    #popup { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); justify-content: center; align-items: center; z-index: 1000; }
    .popup-content { background: white; padding: 20px; width: 90%; max-width: 400px; border-radius: 10px; }
    textarea { width: 100%; height: 150px; font-size: 16px; padding: 10px; margin: 10px 0; border: 1px solid #ccc; box-sizing: border-box; }
    .btn-save { background: #4CAF50; color: white; border: none; padding: 12px; font-size: 16px; border-radius: 5px; cursor: pointer; width: 100%; }
    .btn-close { background: #f44336; color: white; border: none; padding: 5px 10px; float: right; border-radius: 3px; cursor: pointer; }
</style>
</head>
<body>

<div class="header">
<button class="nav" onclick="move(-1)">&#10094; Prev</button>
<h2 id="monthTitle">Loading...</h2>
<button class="nav" onclick="move(1)">Next &#10095;</button>
</div>

<div class="grid">
<div class="day-header">MON</div><div class="day-header">TUE</div><div class="day-header">WED</div><div class="day-header">THU</div><div class="day-header">FRI</div><div class="day-header">SAT</div><div class="day-header">SUN</div>
</div>

<div id="calendarGrid" class="grid"></div>

<div id="popup">
<div class="popup-content">
<button class="btn-close" onclick="closePopup()">X</button>
<h3 id="popupDate">Date</h3>
<textarea id="eventText" placeholder="Details..."></textarea>
<button class="btn-save" onclick="saveEvent()">SAVE & CLOSE</button>
</div>
</div>

<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>

<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-database-compat.js"></script>

<script>
const firebaseConfig = {
apiKey: "AIzaSyAEJfSyTNlcm3uKoC8nqKBzkBjfzmNq-0s",
authDomain: "lesleycalendar-59702.firebaseapp.com",
databaseURL: "https://lesleycalendar-59702-default-rtdb.firebaseio.com",
projectId: "lesleycalendar-59702",
storageBucket: "lesleycalendar-59702.firebasestorage.app",
messagingSenderId: "206794990386",
appId: "1:206794990386:web:dcda160656a516cd7fad2b",
measurementId: "G-9ZG3RJLNTC"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

var currentView = new Date();
var selectedDateId = &quot;&quot;;
var allEvents = {};

db.ref(&quot;events&quot;).on(&quot;value&quot;, function(snapshot) {
    allEvents = snapshot.val() || {};
    drawCalendar();
});

function move(n) {
    currentView.setMonth(currentView.getMonth() + n);
    drawCalendar();
}

function drawCalendar() {
    var year = currentView.getFullYear();
    var month = currentView.getMonth();
    var monthNames = [&quot;January&quot;, &quot;February&quot;, &quot;March&quot;, &quot;April&quot;, &quot;May&quot;, &quot;June&quot;, &quot;July&quot;, &quot;August&quot;, &quot;September&quot;, &quot;October&quot;, &quot;November&quot;, &quot;December&quot;];
    document.getElementById(&quot;monthTitle&quot;).innerText = monthNames[month] + &quot; &quot; + year;

    var firstDay = new Date(year, month, 1).getDay();
    var offset = (firstDay === 0) ? 6 : firstDay - 1; 
    var daysInMonth = new Date(year, month + 1, 0).getDate();
    
    var gridHtml = &quot;&quot;;
    for (var i = 0; i &lt; offset; i++) {
        gridHtml += &quot;&lt;div class=&#39;day-btn&#39; style=&#39;visibility:hidden&#39;&gt;&lt;/div&gt;&quot;;
    }

    for (var day = 1; day &lt;= daysInMonth; day++) {
        var dateId = year + &quot;-&quot; + (month + 1) + &quot;-&quot; + day;
        
        // Calculate day of week for highlighting (0=Sun, 6=Sat)
        var dayOfWeek = new Date(year, month, day).getDay();
        
        var classes = &quot;day-btn&quot;;
        if (dayOfWeek === 0 || dayOfWeek === 6) { classes += &quot; weekend&quot;; }
        if (allEvents[dateId] &amp;&amp; allEvents[dateId].trim() !== &quot;&quot;) { classes += &quot; has-event&quot;; }
        
        var today = new Date();
        if (day === today.getDate() &amp;&amp; month === today.getMonth() &amp;&amp; year === today.getFullYear()) {
            classes += &quot; today&quot;;
        }

        gridHtml += &quot;&lt;button class=&#39;&quot; + classes + &quot;&#39; onclick=&#39;openPopup(\&quot;&quot; + dateId + &quot;\&quot;, &quot; + day + &quot;)&#39;&gt;&quot; + day + &quot;&lt;/button&gt;&quot;;
    }
    document.getElementById(&quot;calendarGrid&quot;).innerHTML = gridHtml;
}

function openPopup(id, dayNum) {
    selectedDateId = id;
    var monthName = document.getElementById(&quot;monthTitle&quot;).innerText.split(&quot; &quot;)[0];
    document.getElementById(&quot;popupDate&quot;).innerText = dayNum + &quot; &quot; + monthName;
    document.getElementById(&quot;eventText&quot;).value = allEvents[id] || &quot;&quot;;
    document.getElementById(&quot;popup&quot;).style.display = &quot;flex&quot;;
    document.getElementById(&quot;eventText&quot;).focus();
}

function saveEvent() {
    var text = document.getElementById(&quot;eventText&quot;).value;
    db.ref(&quot;events/&quot; + selectedDateId).set(text);
    closePopup();
}

function closePopup() {
    document.getElementById(&quot;popup&quot;).style.display = &quot;none&quot;;
}
</script>

</body>
</html>
